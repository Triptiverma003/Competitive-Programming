class Solution {
public:
    bool partition(int index, int currentSum, int target, string &s){
        if(index == s.length()){
            return currentSum == target;
        }
        long long currentNum = 0;
        for(int j = index; j<s.size(); j++){
            currentNum = currentNum * 10 + (s[j]-'0');
            if(currentSum+currentNum > target){
                break;
            }
            if(partition(j+1, currentSum+currentNum, target, s))
            return true;
              
        }
        return false;
    }
    int punishmentNumber(int n) {
        int totalPunishment = 0;
        for(int i = 1; i<=n; i++){
            long long square = (long long)i*i;
            string s = to_string(square);
            if (partition(0,0,i,s)){
                totalPunishment += square;
            }
        }
        return totalPunishment;
    }
};
